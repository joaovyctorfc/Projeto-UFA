<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esqueceu Senha</title>
    <link rel="stylesheet" href="/static/css/home.css">
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="CSS/Principal.css" media="screen" />
    <style>
        /* Adicione o estilo das cores aqui */
        body{


background-color: #0d0d73;

}
/* Centralizar o texto "Login" */
h1 {
text-align: center;
margin-top: 100px; /* Ajuste a margem superior conforme necessário */
}
/* Alterar a cor do link para uma tonalidade mais clara */
a {
color: #4d7dab; /* Cor mais clara do que o azul padrão */
}

/* Ou, se desejar aplicar a uma classe específica */
.link-clara {
color: #4d7dab; /* Cor mais clara para links com a classe "link-clara" */
}

/* Ajustar a posição da div .form_frente sem afetar o "Login" */
.form-control {
    width: 50%; 
    font-size: 14px; 
    text-align: left;
    margin: 0 auto;            
}
.center-input {
display: flex;
justify-content: center;
}
.form_fundo {
    background-color: transparent; /* Fundo transparente */
                padding: 20px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    border: none; 
}

.form_frente {
text-align: center;
padding:  100px -100px; /* Reduzir o preenchimento */
box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
color: #ffffff;
background-color: transparent; /* Fundo transparente */
border: none; /* Remove a borda */
padding: 0; /* Sem preenchimento */
box-shadow: none; /* Remove a sombra */
margin-top: 100px; /* Ajuste a margem superior conforme necessário */


}


.btn-primary {
    background-color: #6289b4;
    color: #fff;
    border: 2px solid #6289b4; 
        }
        .btn-primary:hover {
            background-color: #007bff; }
.btn-secondary:hover {
            background-color: #4d4f51; /* Altera a cor de fundo quando hover */
                    border: 2px solid #5f656a; 

}
.btn-secondary {
            background-color: #6c757d;
            color: #fff;
        }
     
    </style>

    </head>
    <body>
        <h1 style="margin-top: 0px;  color: #fff;">Esqueceu Senha</h1>
    
        <div class="form_frente">
            <form action="/senha" id="email" method="POST">
                <div class="col-md-6 offset-md-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="text" name="email" class="form-control" id="inputEmail" >
                </div>
                <div class="col-12">
                    <button type="button" class="btn btn-primary" style="border-radius: 10px; margin-top: 10px;" id="enviarCodigoBtn">Enviar Código</button>
                </div>
                <div class="col-md-6 offset-md-3">
                    <label for="codigo" class="form-label">Código</label>
                    <input type="text" name="codigo" class ="form-control" id="inputCodigo">
                </div>
                <div class="col-md-6 offset-md-3">
                    <label for="senha" class="form-label">Senha</label>
                    <input type="password" name="senha" class="form-control" id="inputSenha" >
                </div>
                <div class="col-12">
                    <button type="button" class="btn btn-secondary" style="border-radius: 10px; margin-top: 10px;">Gerar Nova Senha</button>
                    <button type="button" class="btn btn-secondary" style="border-radius: 10px; margin-top: 10px;" onclick="window.location.href='/'">Voltar</button>
                </div>
                <div class="col-12" style="margin-top: 10px;">
                    {% set mensagem = get_flashed_messages() %}
                    {% if mensagem %}
                        <div class="flash_alerta" style="color: red;">
                            {{ mensagem[0] }}
                        </div>
                    {% endif %}
                </div>
            </form>
        </div>

        

        <script>

         var userEmail = "{{ session['user_email'] }}";
         var userNome = "{{ session['user_nome'] }}";
         var firebaseConfig = {
            apiKey: "AIzaSyCzKJQhamtH0XAJgK1gvGIFlW7MU9ujm48",
            authDomain: "projeto-drone.firebaseapp.com",
            databaseURL: "https://projeto-drone-default-rtdb.firebaseio.com",
            projectId: "projeto-drone",
            storageBucket: "projeto-drone.appspot.com",
            messagingSenderId: "557356924152",
            appId: "1:557356924152:web:2574dec37d71b47cb20f0d",
            measurementId: "G-N41S4N7B8P"
        };

        firebase.initializeApp(firebaseConfig);

        var database = firebase.database();

        document.getElementById("enviarCodigoBtn").addEventListener("click", function() {
         // ... Configuração do Firebase ...

        document.getElementById("enviarCodigoBtn").addEventListener("click", function() {
    var codigoAleatorio = Math.floor(1000 + Math.random() * 9000);
    var email = document.getElementById("inputEmail").value;

    var usersRef = database.ref("users"); // Substitua "users" pelo caminho correto no seu banco de dados

    usersRef.orderByChild("email").equalTo(email).once("value")
        .then(function(snapshot) {
            if (snapshot.exists()) {
                // O email foi encontrado no banco de dados
                snapshot.forEach(function(childSnapshot) {
                    var userData = childSnapshot.val();
                    var idUsuario = childSnapshot.key;

                    alert("Email encontrado");
                    
                });
            } else {
                // O email não foi encontrado no banco de dados
                alert("Email não encontrado. Por favor, insira um email válido.");
            }
        })
        .catch(function(error) {
            // Lidar com erros, por exemplo, se houver um problema na conexão com o banco de dados
            console.error("Erro ao verificar o email:", error);
        });
});

});

    </script>




    </body>
    </html>
